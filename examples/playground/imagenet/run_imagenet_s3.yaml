resources:
  cloud: aws
  resources: V100

file_mounts:
  /imagenet:
    name: sky-imagenet-data
    mode: MOUNT

setup: |
  git clone https://github.com/Michaelvll/examples.git
  cd ./examples/imagenet
  conda create -n imagenet python=3.9 -y
  conda activate imagenet
  conda install pytorch torchvision torchaudio cudatoolkit=11.3 -c pytorch
  pip install -r requirements.txt
  pip install wandb
  wandb login

run: |
  conda activate imagenet
  mkdir -p /imagenet/checkpoints/ILSRC2012/imagenet/resnet50-s3
  
  python main.py -a resnet50 \
    --save-path /imagenet/checkpoints/ILSRC2012/imagenet/resnet50-s3 \
    --resume /imagenet/checkpoints/ILSRC2012/imagenet/resnet50-s3 \
    /imagenet/datasets/ILSVRC2012/imagenet

